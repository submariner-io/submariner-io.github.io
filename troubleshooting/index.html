<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.71.0" />
    <meta name="description" content="Documentation website for the Submariner project">
<meta name="author" content="The Submariner community">

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Troubleshooting Guide :: Submariner k8s project documentation website</title>

    
    <link href="/css/nucleus.css?1604436520" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1604436520" rel="stylesheet">
    <link href="/css/hybrid.css?1604436520" rel="stylesheet">
    <link href="/css/featherlight.min.css?1604436520" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1604436520" rel="stylesheet">
    <link href="/css/auto-complete.css?1604436520" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1604436520" rel="stylesheet">
    <link href="/css/theme.css?1604436520" rel="stylesheet">
    <link href="/css/hugo-theme.css?1604436520" rel="stylesheet">
    
      <link href="/css/theme-blue.css?1604436520" rel="stylesheet">
    

    <script src="/js/jquery-3.3.1.min.js?1604436520"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/troubleshooting/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a href="/" style="display: block;">
    <object data="/images/logo-submariner.svg" type="image/svg+xml" style="pointer-events: none;">
        <span>Your browser doesn't support SVG images</span>
    </object>
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1604436520"></script>
<script type="text/javascript" src="/js/auto-complete.js?1604436520"></script>
<script type="text/javascript">
    
        var baseurl = "\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1604436520"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/quickstart/" title="Quickstart Guide" class="dd-item 
        
        
        
        ">
      <a href="/quickstart/">
          <b>1. </b>Quickstart Guide
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/quickstart/kind/" title="kind (Local Environment)" class="dd-item 
        
        
        
        ">
      <a href="/quickstart/kind/">
          kind (Local Environment)
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/quickstart/openshift/" title="OpenShift (AWS)" class="dd-item 
        
        
        
        ">
      <a href="/quickstart/openshift/">
          OpenShift (AWS)
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/quickstart/openshift/service_discovery/" title="With Service Discovery" class="dd-item 
        
        
        
        ">
      <a href="/quickstart/openshift/service_discovery/">
          With Service Discovery
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/quickstart/openshift/globalnet/" title="With Service Discovery and Globalnet" class="dd-item 
        
        
        
        ">
      <a href="/quickstart/openshift/globalnet/">
          With Service Discovery and Globalnet
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/quickstart/openshift/create_clusters/" title="" class="dd-item ">
        <a href="/quickstart/openshift/create_clusters/">
        
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/quickstart/openshift/ready_clusters/" title="" class="dd-item ">
        <a href="/quickstart/openshift/ready_clusters/">
        
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/quickstart/openshift/setup_openshift/" title="" class="dd-item ">
        <a href="/quickstart/openshift/setup_openshift/">
        
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/quickstart/vsphere_aws/" title="OpenShift with Service Discovery (vSphere/AWS)" class="dd-item 
        
        
        
        ">
      <a href="/quickstart/vsphere_aws/">
          OpenShift with Service Discovery (vSphere/AWS)
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/quickstart/rancher/" title="Rancher 2.x" class="dd-item 
        
        
        
        ">
      <a href="/quickstart/rancher/">
          Rancher 2.x
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/quickstart/rancher/create_clusters/" title="" class="dd-item ">
        <a href="/quickstart/rancher/create_clusters/">
        
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/quickstart/rancher/prerequisites/" title="" class="dd-item ">
        <a href="/quickstart/rancher/prerequisites/">
        
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/quickstart/verify_with_discovery/" title="" class="dd-item ">
        <a href="/quickstart/verify_with_discovery/">
        
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/deployment/" title="Deployment" class="dd-item 
        
        
        
        ">
      <a href="/deployment/">
          <b>2. </b>Deployment
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/deployment/subctl/" title="subctl" class="dd-item 
        
        
        
        ">
      <a href="/deployment/subctl/">
          subctl
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/deployment/helm/" title="Helm" class="dd-item 
        
        
        
        ">
      <a href="/deployment/helm/">
          Helm
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/deployment/calico/" title="Calico CNI" class="dd-item 
        
        
        
        ">
      <a href="/deployment/calico/">
          Calico CNI
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/architecture/" title="Architecture" class="dd-item 
        
        
        
        ">
      <a href="/architecture/">
          <b>3. </b>Architecture
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/architecture/broker/" title="Broker" class="dd-item 
        
        
        
        ">
      <a href="/architecture/broker/">
          Broker
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/architecture/gateway-engine/" title="Gateway Engine" class="dd-item 
        
        
        
        ">
      <a href="/architecture/gateway-engine/">
          Gateway Engine
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/architecture/route-agent/" title="Route Agent" class="dd-item 
        
        
        
        ">
      <a href="/architecture/route-agent/">
          Route Agent
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/architecture/globalnet/" title="Globalnet Controller" class="dd-item 
        
        
        
        ">
      <a href="/architecture/globalnet/">
          Globalnet Controller
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/architecture/service-discovery/" title="Service Discovery" class="dd-item 
        
        
        
        ">
      <a href="/architecture/service-discovery/">
          Service Discovery
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/monitoring/" title="Monitoring" class="dd-item 
        
        
        
        ">
      <a href="/monitoring/">
          <b>4. </b>Monitoring
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/troubleshooting/" title="Troubleshooting Guide" class="dd-item 
        parent
        active
        
        ">
      <a href="/troubleshooting/">
          <b>5. </b>Troubleshooting Guide
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/releases/" title="Releases" class="dd-item 
        
        
        
        ">
      <a href="/releases/">
          <b>6. </b>Releases
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/reading_material/" title="Online Resources" class="dd-item 
        
        
        
        ">
      <a href="/reading_material/">
          <b>7. </b>Online Resources
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/roadmap/" title="Roadmap" class="dd-item 
        
        
        
        ">
      <a href="/roadmap/">
          <b>8. </b>Roadmap
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/contributing/" title="Contributing" class="dd-item 
        
        
        
        ">
      <a href="/contributing/">
          <b>9. </b>Contributing
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/contributing/building_testing/" title="Building and Testing" class="dd-item 
        
        
        
        ">
      <a href="/contributing/building_testing/">
          Building and Testing
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/contributing/code-of-conduct/" title="Code of Conduct" class="dd-item 
        
        
        
        ">
      <a href="/contributing/code-of-conduct/">
          Code of Conduct
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/contributing/code-review/" title="Code Review Guide" class="dd-item 
        
        
        
        ">
      <a href="/contributing/code-review/">
          Code Review Guide
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/contributing/community-membership/" title="Community Membership" class="dd-item 
        
        
        
        ">
      <a href="/contributing/community-membership/">
          Community Membership
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/contributing/website/" title="Contributing to the Website" class="dd-item 
        
        
        
        ">
      <a href="/contributing/website/">
          Contributing to the Website
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            




 
  
    
      <li data-nav-id="/contributing/website/style_guide/" title="Docs Style Guide" class="dd-item ">
        <a href="/contributing/website/style_guide/">
        Docs Style Guide
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/contributing/release-process/" title="Release Process" class="dd-item 
        
        
        
        ">
      <a href="/contributing/release-process/">
          Release Process
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/contributing/security/" title="Security Reporting" class="dd-item 
        
        
        
        ">
      <a href="/contributing/security/">
          Security Reporting
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/contributing/shipyard/" title="Working With Shipyard" class="dd-item 
        
        
        
        ">
      <a href="/contributing/shipyard/">
          Working With Shipyard
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/contributing/shipyard/first_time/" title="Adding Shipyard to a Project" class="dd-item 
        
        
        
        ">
      <a href="/contributing/shipyard/first_time/">
          Adding Shipyard to a Project
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/contributing/shipyard/advanced/" title="Advanced Features" class="dd-item 
        
        
        
        ">
      <a href="/contributing/shipyard/advanced/">
          Advanced Features
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="https://github.com/submariner-io/"><i class='fab fa-fw fa-github'></i> GitHub</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://kubernetes.slack.com/archives/C010RJV694M"><i class='fab fa-fw fa-slack'></i> Slack</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://bit.ly/submariner-users"><i class='fas fa-fw fa-envelope'></i> User mailing list</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://bit.ly/submariner-dev"><i class='fas fa-fw fa-envelope'></i> Devel mailing list</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://www.youtube.com/channel/UCZ3brSgl2v4boglZoeChClQ/videos"><i class='fas fa-fw fa-video'></i> YouTube</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://twitter.com/submarinerio"><i class='fab fa-fw fa-twitter'></i> Twitter</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://calendar.google.com/calendar?cid=NHFuZGVoOGY0bzZ1ajlvZnBsczh1NWNlZ2tAZ3JvdXAuY2FsZW5kYXIuZ29vZ2xlLmNvbQ"><i class='fas fa-fw fa-calendar'></i> Google Calendar</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
      
      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      <center>
    
    <a class="github-button" href="https://github.com/submariner-io/submariner-operator/releases" data-icon="octicon-cloud-download" aria-label="Download Submariner/subctl on github">Download</a>

    
    <a class="github-button" href="https://github.com/submariner-io/submariner" data-icon="octicon-star" data-show-count="true" aria-label="Star submariner-io/submariner on GitHub">Star</a>

    
    <a class="github-button" href="https://github.com/submariner-io/submariner/fork" data-icon="octicon-repo-forked" data-show-count="true" aria-label="Fork submariner-io/submariner on GitHub">Fork</a>

</center>

<script async defer src="https://buttons.github.io/buttons.js"></script>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                  
                  
                  
                  <div id="top-github-link">
                    <a class="github-link" title='Edit this page' href="https://github.com/submariner-io/website/edit/master/src/content/troubleshooting/_index.en.md" target="blank">
                      <i class="fas fa-code-branch"></i>
                      <span id="top-github-link-text">Edit this page</span>
                    </a>
                  </div>
                  
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            <a href='/'></a> > Troubleshooting Guide
          
         
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#overview">Overview</a>
      <ul>
        <li><a href="#pre-requisite">Pre-requisite</a></li>
        <li><a href="#service-discovery-issues">Service Discovery Issues</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Troubleshooting Guide
            </h1>
          

        




	<h2 id="overview">Overview</h2>
<p>You have followed steps in <a href="../deployment">Deployment</a> but something has gone wrong. You&rsquo;re not sure what and how to fix it, or what
information to collect to raise an issue. Welcome to the Submariner troubleshooting guide where we will help you get your deployment working
again.</p>
<p>Basic familiarity with the Submariner components and architecture will be helpful when troubleshooting so please review the
<a href="../architecture">Architecture</a> section.</p>
<p>The guide has been broken into different sections for easy navigation.</p>
<h3 id="pre-requisite">Pre-requisite</h3>
<p>Before we begin troubleshooting, run <code>subctl version</code> to obtain which version of the Submariner components you are running.</p>
<p>Run <code>kubectl get services -n &lt;service-namespace&gt; | grep &lt;service-name&gt;</code> to get information about the service you&rsquo;re trying to access. This
will provide you with the Service <em>Name</em>, <em>Namespace</em> and <em>ServiceIP</em>. If <strong>Globalnet</strong> is enabled, you will also need the <em>globalIp</em> of the
service by running</p>
<p><code>kubectl get service &lt;service-name&gt; -o jsonpath='{.metadata.annotations.submariner\.io/globalIp}'</code></p>
<!---

### Deployment Issues

This section will contain information about common deployment issues you can run into.

#### TBD

### Connectivity Issues

Submariner deployment completed successfully but Services/Pods on one cluster are unable to connect to Services on another cluster. This can
be due to multiple factors outlined in the following sections.

#### IPSec tunnel not created between clusters

TBD

#### IPSEc tunnel is not up between clusters

TBD

#### None of pods/services able to connect to remote service

TBD

##### Without Globalnet

TBD

##### With Globalnet

TBD

#### Pods on non-gateway nodes not able to connect to remote service

TBD

##### Without Globalnet

TBD

##### With Globalnet

TBD

-->
<h3 id="service-discovery-issues">Service Discovery Issues</h3>
<p>If you are able to connect to remote service by using ServiceIP or globalIp, but not by service name, it is a Service Discovery Issue.</p>
<h4 id="service-discovery-not-working">Service Discovery not working</h4>
<p>This is good time to familiarize yourself with <a href="../architecture/service-discovery/">Service Discovery Architecture</a> if you haven&rsquo;t already.</p>
<h5 id="check-serviceexport-for-your-service">Check ServiceExport for your Service</h5>
<p>For a Service to be accessible across clusters, you must first export the Service via <code>subctl</code> which creates a <code>ServiceExport</code> resource.
Ensure the <code>ServiceExport</code> resource exists and check if its status condition indicates `Exported&rsquo;. Otherwise, its status condition will
indicate the reason it wasn&rsquo;t exported.</p>
<p><code>kubectl get serviceexport -n &lt;service-namespace&gt; &lt;service-name&gt;</code></p>
<p>Sample output:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#66d9ef">apiVersion</span>: lighthouse.submariner.io/v2alpha1
<span style="color:#66d9ef">kind</span>: ServiceExport
<span style="color:#66d9ef">metadata</span>:
  <span style="color:#66d9ef">name</span>: nginx
<span style="color:#66d9ef">Status</span>:
  <span style="color:#66d9ef">Conditions</span>:
    <span style="color:#66d9ef">Message</span>:  Service was successfully synced to the broker
    <span style="color:#66d9ef">Status</span>:   True
    <span style="color:#66d9ef">Type</span>:     Exported
</code></pre></div><h5 id="check-lighthouse-coredns-service">Check Lighthouse CoreDNS Service</h5>
<p>All cross-cluster service queries are handled by Lighthouse CoreDNS server. First we check if the Lighthouse CoreDNS Service is running
properly.</p>
<p><code>kubectl -n submariner-operator get service submariner-lighthouse-coredns</code></p>
<p>If it is running fine, note down the <code>ServiceIP</code> for the next steps. If not, check the logs for an error.</p>
<p>If the error is due to a wrong image, run <code>kubectl -n submariner-operator get deployment submariner-lighthouse-coredns</code> and make sure
<code>Image</code> is set to <code>quay.io/submariner/lighthouse-coredns:&lt;version&gt;</code> and refers to the correct version.</p>
<p>For any other errors, capture the information and raise a new <a href="https://github.com/submariner-io/lighthouse/issues">issue</a></p>
<p>If there&rsquo;s no error, then check if the Lighthouse CoreDNS server is configured correctly. Run <code>kubectl -n submariner-operator describe configmap submariner-lighthouse-coredns</code> and make sure it has following configuration:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">    clusterset.local:53 {
        lighthouse
        errors
        health
        ready
    }
</code></pre></div><h5 id="check-coredns-configuration">Check CoreDNS Configuration</h5>
<p>Submariner requires the CoreDNS deployment to forward requests for the domain <code>clusterset.local</code> to the Lighthouse CoreDNS server in the
cluster making the query. Ensure this configuration exists and is correct.</p>
<p>First we check if CoreDNS is configured to forward requests for domain <code>clusterset.local</code> to Lighthouse CoreDNS Server in the cluster
making the query.</p>
<p><code>kubectl -n kube-system describe configmap coredns</code></p>
<p>In the output look for something like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">    clusterset.local:53 {
        forward . &lt;lighthouse-coredns-serviceip&gt; ======&gt; ServiceIP of lighthouse-coredns service as noted in previous section
    }
</code></pre></div><p>If the entries highlighted above are missing or <code>ServiceIp</code> is incorrect, it means CoreDNS wasn&rsquo;t configured correctly. It can be fixed by
running <code>kubectl edit configmap coredns</code> and making the changes manually. You may need to repeat this step on every cluster.</p>
<h5 id="check-submariner-lighthouse-agent">Check submariner-lighthouse-agent</h5>
<p>Next we check if the <code>submariner-lighthouse-agent</code> is properly running. Run <code>kubectl -n submariner-operator get pods submariner-lighthouse-agent</code> and check the status of Pods.</p>
<p>If the status indicates the <code>ImagePullBackOff</code> error, run <code>kubectl -n submariner-operator describe deployment submariner-lighthouse-agent</code>
and check if <code>Image</code> is set correctly to <code>quay.io/submariner/lighthouse-agent:&lt;version&gt;</code>. If it is and the same error still occurs, raise an
issue <a href="https://github.com/submariner-io/lighthouse/issues">here</a> or ping us on the community slack channel.</p>
<p>If the status indicates any other error, run <code>kubectl -n submariner-operator get pods</code> to get the name of the <code>lighthouse-agent</code> Pod. Then
run <code>kubectl -n submariner-operator logs &lt;lighthouse-agent-pod-name&gt;</code> to get the logs. See if there are any errors in the log. If yes, raise
an <a href="https://github.com/submariner-io/lighthouse/issues">issue</a> with the log contents, or you can continue reading through this guide to
troubleshoot further.</p>
<p>If there are no errors, grep the log for the service name that you&rsquo;re trying to query as we may need the log entries later for raising an
issue.</p>
<h5 id="check-serviceimport-resources">Check ServiceImport resources</h5>
<p>If the steps above did not indicate an issue, next we check if the ServiceImport resources were properly created for the service you&rsquo;re
trying to access. The format of a ServiceImport resources&rsquo;s name is as follows:</p>
<p><code>&lt;service-name&gt;-&lt;service-namespace&gt;-&lt;cluster-id&gt;</code></p>
<p>Run <code>kubectl get serviceimports --all-namespaces |grep &lt;your-service-name&gt;</code> on the Broker cluster to check if a resource was created for
your service. If not, then check the Lighthouse Agent logs on the cluster where service was created and look for any error or warning
messages indicating a failure to create the ServiceImport resource for your service. The most common error is <code>Forbidden</code> if the RBAC wasn&rsquo;t
configured correctly. Depending on the deployment method used, &lsquo;subctl&rsquo; or &lsquo;helm&rsquo;, it should&rsquo;ve been done for you. Create an
<a href="https://github.com/submariner-io/lighthouse/issues">issue</a> with relevant log entries.</p>
<p>If the ServiceImport resource was created correctly on the Broker cluster, the next step is to check if it exists on the cluster where
you&rsquo;re trying to access the service. Follow the same steps as earlier to get the list of the ServiceImport resources and check if the
ServiceImport for your service exists. If not, check the logs of the Lighthouse Agent on the cluster where you are trying to access the
service. As described earlier, it will most commonly be an issue with RBAC otherwise create an
<a href="https://github.com/submariner-io/lighthouse/issues">issue</a> with relevant log entries.</p>
<p>If the ServiceImport resource was created properly on the cluster, run
<code>kubectl -n submariner-operator describe serviceimport &lt;your-serviceimport-name&gt;</code>
and check if it has the correct <code>ClusterID</code> and <code>ServiceIP</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">Name:         nginx-default-cluster2
Namespace:    submariner-operator
Labels:       &lt;none&gt;
Annotations:  origin-name: nginx
              origin-namespace: default
API Version:  lighthouse.submariner.io/v2alpha1
Kind:         ServiceImport
Metadata:
  Creation Timestamp:  2020-07-14T17:27:32Z
  Generation:          1
  Resource Version:    2790
  Self Link:           /apis/lighthouse.submariner.io/v2alpha1/namespaces/submariner-operator/serviceimports/nginx-default-cluster2
  UID:                 4cbe1c2b-c5f7-11ea-9bbe-0242ac110009
Spec:
  Ports:                    &lt;nil&gt;
  Session Affinity:
  Session Affinity Config:  &lt;nil&gt;
  Type:                     ClusterSetIP
Status:
  Clusters:
    Cluster:  cluster2 ==========&gt; ClusterID of cluster where service is running
    Ips:
      100.92.43.63     ==========&gt; ServiceIP or GlobalIP of service you&#39;re trying to access
Events:  &lt;none&gt;
</code></pre></div><p>For headless Service, you need to check <code>EndpointSlice</code> resource.</p>
<p>If the data is not correct, you can manually edit the ServiceImport resource to set the correct IP as a workaround and create an
<a href="https://github.com/submariner-io/lighthouse/issues">issue</a> with relevant information.</p>
<p>If the ServiceImport <code>Ips</code> are correct but still not being returned from DNS queries, check the connectivity to the cluster
using <a href="../deployment/subctl/_index.en.md#show-endpoints"><code>subctl show endpoint</code></a>. The Lighthouse CoreDNS Server only returns IPs
from connected clusters.</p>
<h5 id="check-endpointslice-resources">Check EndpointSlice resources</h5>
<p>For a headless Service, next we check if the EndpointSlice resources were properly created for the service you&rsquo;re
trying to access. EndpointSlice resources are created in the same namespace as the source Service. The format of a EndpointSlice
resource&rsquo;s name is as follows:</p>
<p><code>&lt;service-name&gt;--&lt;cluster-id&gt;</code></p>
<p>Run <code>kubectl get endpointslices --all-namespaces |grep &lt;your-service-name&gt;</code> on the Broker cluster to check if a resource was created for
your Service. If not, then check the Lighthouse Agent logs on the cluster where the Service was created and look for any error or warning
messages indicating a failure to create the ServiceImport resource for your Service. The most common error is <code>Forbidden</code> if the RBAC wasn&rsquo;t
configured correctly. This is supposed to be done automatically during deployment so please file an
<a href="https://github.com/submariner-io/lighthouse/issues">issue</a> with the relevant log entries.</p>
<p>If the EndpointSlice resource was created correctly on the Broker cluster, the next step is to check if it exists on the cluster where
you&rsquo;re trying to access the Service. Follow the same steps as earlier to get the list of the EndpointSlice resources and check if the
EndpointSlice for the Service exists. If not, check the logs of the Lighthouse Agent on the cluster where you are trying to access the
Service. As described earlier, it will most commonly be an issue with RBAC so create an
<a href="https://github.com/submariner-io/lighthouse/issues">issue</a> with relevant log entries.</p>
<p>If the EndpointSlice resource was created properly on the cluster, run
<code>kubectl -n &lt;your-service-namespace&gt; describe endpointslice &lt;your-endpointslice-name&gt;</code>
and check if it has the correct endpoint addresses:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">Name:         nginx-ss-cluster2
Namespace:    default
Labels:       endpointslice.kubernetes.io/managed-by=lighthouse-agent.submariner.io
              lighthouse.submariner.io/sourceCluster=cluster2
              lighthouse.submariner.io/sourceName=nginx-ss
              lighthouse.submariner.io/sourceNamespace=default
              multicluster.kubernetes.io/service-name=nginx-ss-default-cluster2
Annotations:  &lt;none&gt;
AddressType:  IPv4
Ports:
  Name  Port  Protocol
  ----  ----  --------
  web   80    TCP
Endpoints:
  - Addresses:  10.242.0.5  -----&gt; Pod IP
    Conditions:
      Ready:    true
    Hostname:   web-0   -----&gt; Pod hostname
    Topology:   kubernetes.io/hostname=cluster2-worker2
  - Addresses:  10.242.224.4
    Conditions:
      Ready:   true
    Hostname:  web-1
    Topology:  kubernetes.io/hostname=cluster2-worker
Events:        &lt;none&gt;
</code></pre></div><p>If the <code>Addresses</code> are correct but still not being returned from DNS queries, try querying IPs in a specific cluster
by prefixing the query with <code>&lt;cluster-id&gt;.</code> If that returns the IPs correctly, then check the connectivity to the cluster
using <a href="../deployment/subctl/_index.en.md#show-endpoints"><code>subctl show endpoint</code></a>. The Lighthouse CoreDNS Server only returns IPs
from connected clusters.</p>
<p>For errors querying specific Pods of a StatefulSet, check that the <code>Hostname</code> is correct for the endpoint.</p>
<p>If still not working, file an <a href="https://github.com/submariner-io/lighthouse/issues">issue</a> with relevant log entries.</p>





<footer class=" footline" >
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/monitoring/" title="Monitoring"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/releases/" title="Releases" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1604436520"></script>
    <script src="/js/perfect-scrollbar.min.js?1604436520"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1604436520"></script>
    <script src="/js/jquery.sticky.js?1604436520"></script>
    <script src="/js/featherlight.min.js?1604436520"></script>
    <script src="/js/highlight.pack.js?1604436520"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1604436520"></script>
    <script src="/js/learn.js?1604436520"></script>
    <script src="/js/hugo-learn.js?1604436520"></script>

    <link href="/mermaid/mermaid.css?1604436520" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1604436520"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>
