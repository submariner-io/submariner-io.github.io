<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.67.1" />
    <meta name="description" content="Documentation website for the submariner project">
<meta name="author" content="The submariner community">

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Lighthouse :: Submariner k8s project documentation website</title>

    
    <link href="/css/nucleus.css?1584351864" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1584351864" rel="stylesheet">
    <link href="/css/hybrid.css?1584351864" rel="stylesheet">
    <link href="/css/featherlight.min.css?1584351864" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1584351864" rel="stylesheet">
    <link href="/css/auto-complete.css?1584351864" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1584351864" rel="stylesheet">
    <link href="/css/theme.css?1584351864" rel="stylesheet">
    <link href="/css/hugo-theme.css?1584351864" rel="stylesheet">
    
      <link href="/css/theme-blue.css?1584351864" rel="stylesheet">
    

    <script src="/js/jquery-3.3.1.min.js?1584351864"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/en/architecture/components/lighthouse/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <img src="/images/logo-submariner.svg" alt="Submariner"/>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1584351864"></script>
<script type="text/javascript" src="/js/auto-complete.js?1584351864"></script>
<script type="text/javascript">
    
        var baseurl = "\/\/en";
    
</script>
<script type="text/javascript" src="/js/search.js?1584351864"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/en/quickstart/" title="Quickstart guide" class="dd-item 
        
        
        
        ">
      <a href="/en/quickstart/">
          <b>1. </b>Quickstart guide
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/en/quickstart/openshift/" title="OpenShift (AWS)" class="dd-item 
        
        
        
        ">
      <a href="/en/quickstart/openshift/">
          OpenShift (AWS)
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/en/deployment/" title="Deployment" class="dd-item 
        
        
        
        ">
      <a href="/en/deployment/">
          <b>2. </b>Deployment
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/en/deployment/subctl/" title="subctl" class="dd-item 
        
        
        
        ">
      <a href="/en/deployment/subctl/">
          subctl
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/en/deployment/helm/" title="helm" class="dd-item 
        
        
        
        ">
      <a href="/en/deployment/helm/">
          helm
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/en/deployment/with-discovery/" title="With Discovery (experimental)" class="dd-item ">
        <a href="/en/deployment/with-discovery/">
        With Discovery (experimental)
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/en/architecture/" title="Architecture" class="dd-item 
        parent
        
        
        ">
      <a href="/en/architecture/">
          <b>3. </b>Architecture
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/en/architecture/network/" title="Network" class="dd-item 
        
        
        
        ">
      <a href="/en/architecture/network/">
          Network
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/en/architecture/components/" title="Submariner components" class="dd-item 
        parent
        
        
        ">
      <a href="/en/architecture/components/">
          Submariner components
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/en/architecture/components/lighthouse/" title="Lighthouse" class="dd-item 
        parent
        active
        
        ">
      <a href="/en/architecture/components/lighthouse/">
          Lighthouse
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/en/releases/" title="Releases" class="dd-item 
        
        
        
        ">
      <a href="/en/releases/">
          <b>4. </b>Releases
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/en/roadmap/" title="Roadmap" class="dd-item 
        
        
        
        ">
      <a href="/en/roadmap/">
          <b>5. </b>Roadmap
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/en/contributing/" title="Contributing" class="dd-item 
        
        
        
        ">
      <a href="/en/contributing/">
          <b>6. </b>Contributing
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/en/contributing/website/" title="Contributing to the website" class="dd-item 
        
        
        
        ">
      <a href="/en/contributing/website/">
          Contributing to the website
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/en/contributing/code-of-conduct/" title="Code of Conduct" class="dd-item 
        
        
        
        ">
      <a href="/en/contributing/code-of-conduct/">
          Code of Conduct
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="https://github.com/submariner-io/"><i class='fab fa-fw fa-github'></i> GitHub repo</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://bit.ly/submariner-users"><i class='fas fa-fw fa-envelope'></i> User mailing list</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://bit.ly/submariner-dev"><i class='fas fa-fw fa-envelope'></i> Devel mailing list</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://www.youtube.com/channel/UCZ3brSgl2v4boglZoeChClQ/videos"><i class='fas fa-fw fa-video'></i> Youtube demos</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://twitter.com/submarinerio"><i class='fas fa-fw fa-bookmark'></i> Twitter</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
        <li>
          <a class="padding">
            <i class="fas fa-language fa-fw"></i>
          <div class="select-style">
            <select id="select-language" onchange="location = this.value;">
          
          
          
              
              
                  
                    
                    
                      <option id="en" value="/en/architecture/components/lighthouse/" selected>English</option>
                    
                  
              
                  
              
          
        </select>
        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
          width="255px" height="255px" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255;" xml:space="preserve">
          <g>
            <g id="arrow-drop-down">
              <polygon points="0,63.75 127.5,191.25 255,63.75 		" />
            </g>
          </g>
        </svg>
        </div>
        </a>
        </li>
      
      
      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      <center>
    
    <a class="github-button" href="https://github.com/submariner-io/submariner-operator/releases" data-icon="octicon-cloud-download" aria-label="Download Submariner/subctl on github">Download</a>

    
    <a class="github-button" href="https://github.com/submariner-io/submariner" data-icon="octicon-star" data-show-count="true" aria-label="Star submariner-io/submariner on GitHub">Star</a>

    
    <a class="github-button" href="https://github.com/submariner-io/submariner/fork" data-icon="octicon-repo-forked" data-show-count="true" aria-label="Fork submariner-io/submariner on GitHub">Fork</a>

</center>

<script async defer src="https://buttons.github.io/buttons.js"></script>

    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                  
                  
                  
                  <div id="top-github-link">
                    <a class="github-link" title='Edit this page' href="https://github.com/submariner-io/website/edit/master/src/content/architecture/components/lighthouse/_index.en.md" target="blank">
                      <i class="fas fa-code-branch"></i>
                      <span id="top-github-link-text">Edit this page</span>
                    </a>
                  </div>
                  
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            
            
          
          
            <a href='/en/'>Submariner</a> > <a href='/en/architecture/'>Architecture</a> > <a href='/en/architecture/components/'>Submariner components</a> > Lighthouse
          
         
          
         
          
         
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#architecture">Architecture</a>
      <ul>
        <li><a href="#lighthouse-controller">Lighthouse Controller</a></li>
        <li><a href="#lighthouse-plugin">Lighthouse Plugin</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Lighthouse
            </h1>
          

        




	<p>Lighthouse provides DNS discovery for Kubernetes clusters connected by <a href="https://github.com/submariner-io/submariner">Submariner</a> in multi-cluster environments. The solution is compatible with any CNI (Container Network Interfaces) plugin.</p>
<h2 id="architecture">Architecture</h2>
<p>The below digram shows the basic Lighthouse architecture.</p>
<p><img src="/images/lighthouse/architecture.png" alt="Lighthouse Architecture"></p>
<h3 id="lighthouse-controller">Lighthouse Controller</h3>
<p>This is the central discovery controller that gathers the information from the clusters, decides what information is to be shared and distributes the information as newly defined CRDs (Kubernetes custom resources).</p>
<p>The Lighthouse controller uses <a href="https://github.com/kubernetes-sigs/kubefed">kubefed</a> to discover clusters and to extract and distribute aggregated Service information used to perform DNS resolution.</p>
<h4 id="workflow">WorkFlow</h4>
<p>The workflow is as follows.</p>
<ul>
<li>Lighthouse controller registers to be notified when clusters join and unjoin the kubefed control plane.</li>
<li>When notified about a join event, it retrieves the credentials from kubefed and registers a watch for Service creation and removal on that cluster.</li>
<li>When notified of a new Service created, it creates a MultiClusterService resource with the Service info and distributes it to all the clusters that are connected to the kubefed  control plane.</li>
<li>When notified of a Service deleted, its info is removed from the MultiClusterService resource and re-distributed.</li>
</ul>
<p><img src="/images/lighthouse/controllerWorkFlow.png" alt="Lighthouse Controller WorkFlow"></p>
<!-- raw HTML omitted -->
<h3 id="lighthouse-plugin">Lighthouse Plugin</h3>
<p>Lighthouse plugin can be installed as an external plugin for CoreDNS, and will work along with the default Kubernetes plugin. It uses the MultiClusterService resources that are distributed by the controller for DNS resolution. The below diagram indicates a high-level architecture.</p>
<p><img src="/images/lighthouse/lighthousePluginArchitecture.png" alt="Lighthouse Plugin Architecture"></p>
<h4 id="workflow-1">WorkFlow</h4>
<p>The workflow is as follows.</p>
<ul>
<li>A pod tries to resolve a Service name.</li>
<li>The Kubernetes plugin in CoreDNS will first try to resolve the request. If no records are present the request will be sent to Lighthouse plugin.</li>
<li>The Lighthouse plugin will use its MultiClusterService cache to try to resolve the request.</li>
<li>If a record exists it will be returned, otherwise the plugin will pass the request to the next plugin registered in CoreDNS.</li>
</ul>
<p><img src="/images/lighthouse/coreDNSWorkFlow.png" alt="Lighthouse CoreDNS WorkFlow"></p>
<!-- raw HTML omitted -->





<footer class=" footline" >
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/en/architecture/components/" title="Submariner components"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/en/releases/" title="Releases" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1584351864"></script>
    <script src="/js/perfect-scrollbar.min.js?1584351864"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1584351864"></script>
    <script src="/js/jquery.sticky.js?1584351864"></script>
    <script src="/js/featherlight.min.js?1584351864"></script>
    <script src="/js/highlight.pack.js?1584351864"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1584351864"></script>
    <script src="/js/learn.js?1584351864"></script>
    <script src="/js/hugo-learn.js?1584351864"></script>

    <link href="/mermaid/mermaid.css?1584351864" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1584351864"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>
