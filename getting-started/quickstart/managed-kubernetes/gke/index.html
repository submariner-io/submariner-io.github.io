<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.71.0" />
    <meta name="description" content="Documentation website for the Submariner project">
<meta name="author" content="The Submariner community">

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Google (GKE) :: Submariner k8s project documentation website</title>

    
    <link href="/css/nucleus.css?1707219466" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1707219466" rel="stylesheet">
    <link href="/css/hybrid.css?1707219466" rel="stylesheet">
    <link href="/css/featherlight.min.css?1707219466" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1707219466" rel="stylesheet">
    <link href="/css/auto-complete.css?1707219466" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1707219466" rel="stylesheet">
    <link href="/css/theme.css?1707219466" rel="stylesheet">
    <link href="/css/hugo-theme.css?1707219466" rel="stylesheet">
    
      <link href="/css/theme-blue.css?1707219466" rel="stylesheet">
    

    <script src="/js/jquery-3.3.1.min.js?1707219466"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
<link href="/css/fixes.css?1707219466" rel="stylesheet">

  </head>
  <body class="" data-url="/getting-started/quickstart/managed-kubernetes/gke/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a href="/" style="display: block;">
    <object data="/images/logo-submariner.svg" type="image/svg+xml" style="pointer-events: none;">
        <span>Your browser doesn't support SVG images</span>
    </object>
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1707219466"></script>
<script type="text/javascript" src="/js/auto-complete.js?1707219466"></script>
<script type="text/javascript">
    
        var baseurl = "\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1707219466"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/getting-started/" title="Getting Started" class="dd-item 
        parent
        
        
        ">
      <a href="/getting-started/">
          <b>1. </b>Getting Started
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/getting-started/architecture/" title="Architecture" class="dd-item 
        
        
        
        ">
      <a href="/getting-started/architecture/">
          Architecture
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/getting-started/architecture/broker/" title="Broker" class="dd-item 
        
        
        
        ">
      <a href="/getting-started/architecture/broker/">
          Broker
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/getting-started/architecture/gateway-engine/" title="Gateway Engine" class="dd-item 
        
        
        
        ">
      <a href="/getting-started/architecture/gateway-engine/">
          Gateway Engine
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/getting-started/architecture/service-discovery/" title="Service Discovery" class="dd-item 
        
        
        
        ">
      <a href="/getting-started/architecture/service-discovery/">
          Service Discovery
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/getting-started/architecture/globalnet/" title="Globalnet Controller" class="dd-item 
        
        
        
        ">
      <a href="/getting-started/architecture/globalnet/">
          Globalnet Controller
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/getting-started/architecture/networkplugin-syncer/" title="Network Plugin Syncer" class="dd-item 
        
        
        
        ">
      <a href="/getting-started/architecture/networkplugin-syncer/">
          Network Plugin Syncer
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/getting-started/architecture/networkplugin-syncer/ovn-kubernetes/" title="OVN Kubernetes" class="dd-item 
        
        
        
        ">
      <a href="/getting-started/architecture/networkplugin-syncer/ovn-kubernetes/">
          OVN Kubernetes
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/getting-started/architecture/route-agent/" title="Route Agent" class="dd-item 
        
        
        
        ">
      <a href="/getting-started/architecture/route-agent/">
          Route Agent
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/getting-started/quickstart/" title="Quickstart Guides" class="dd-item 
        parent
        
        
        ">
      <a href="/getting-started/quickstart/">
          Quickstart Guides
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/getting-started/quickstart/kind/" title="Sandbox Environment (kind)" class="dd-item 
        
        
        
        ">
      <a href="/getting-started/quickstart/kind/">
          Sandbox Environment (kind)
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/getting-started/quickstart/managed-kubernetes/" title="Managed Kubernetes" class="dd-item 
        parent
        
        
        ">
      <a href="/getting-started/quickstart/managed-kubernetes/">
          Managed Kubernetes
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/getting-started/quickstart/managed-kubernetes/gke/" title="Google (GKE)" class="dd-item 
        parent
        active
        
        ">
      <a href="/getting-started/quickstart/managed-kubernetes/gke/">
          Google (GKE)
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/getting-started/quickstart/managed-kubernetes/rancher/" title="Rancher" class="dd-item 
        
        
        
        ">
      <a href="/getting-started/quickstart/managed-kubernetes/rancher/">
          Rancher
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/getting-started/quickstart/openshift/" title="OpenShift" class="dd-item 
        
        
        
        ">
      <a href="/getting-started/quickstart/openshift/">
          OpenShift
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/getting-started/quickstart/openshift/aws/" title="On AWS" class="dd-item 
        
        
        
        ">
      <a href="/getting-started/quickstart/openshift/aws/">
          On AWS
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/getting-started/quickstart/openshift/globalnet/" title="On AWS with Globalnet" class="dd-item 
        
        
        
        ">
      <a href="/getting-started/quickstart/openshift/globalnet/">
          On AWS with Globalnet
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/getting-started/quickstart/openshift/azure/" title="On Azure" class="dd-item 
        
        
        
        ">
      <a href="/getting-started/quickstart/openshift/azure/">
          On Azure
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/getting-started/quickstart/openshift/gcp-lb/" title="On GCP (LoadBalancer mode)" class="dd-item 
        
        
        
        ">
      <a href="/getting-started/quickstart/openshift/gcp-lb/">
          On GCP (LoadBalancer mode)
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/getting-started/quickstart/openshift/vsphere-aws/" title="Hybrid vSphere and AWS" class="dd-item 
        
        
        
        ">
      <a href="/getting-started/quickstart/openshift/vsphere-aws/">
          Hybrid vSphere and AWS
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/getting-started/quickstart/openshift/rhos/" title="Hybrid OpenStack and AWS" class="dd-item 
        
        
        
        ">
      <a href="/getting-started/quickstart/openshift/rhos/">
          Hybrid OpenStack and AWS
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/getting-started/quickstart/external/" title="External Network (Experimental)" class="dd-item 
        
        
        
        ">
      <a href="/getting-started/quickstart/external/">
          External Network (Experimental)
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/operations/" title="Operations" class="dd-item 
        
        
        
        ">
      <a href="/operations/">
          <b>2. </b>Operations
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/operations/deployment/" title="Deployment" class="dd-item 
        
        
        
        ">
      <a href="/operations/deployment/">
          Deployment
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/operations/deployment/subctl/" title="subctl" class="dd-item 
        
        
        
        ">
      <a href="/operations/deployment/subctl/">
          subctl
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/operations/deployment/helm/" title="Helm" class="dd-item 
        
        
        
        ">
      <a href="/operations/deployment/helm/">
          Helm
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/operations/deployment/calico/" title="Calico CNI" class="dd-item 
        
        
        
        ">
      <a href="/operations/deployment/calico/">
          Calico CNI
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/operations/upgrading/" title="Upgrading" class="dd-item 
        
        
        
        ">
      <a href="/operations/upgrading/">
          Upgrading
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/operations/usage/" title="User Guide" class="dd-item 
        
        
        
        ">
      <a href="/operations/usage/">
          User Guide
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/operations/monitoring/" title="Monitoring" class="dd-item 
        
        
        
        ">
      <a href="/operations/monitoring/">
          Monitoring
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/operations/nat-traversal/" title="NAT Traversal" class="dd-item 
        
        
        
        ">
      <a href="/operations/nat-traversal/">
          NAT Traversal
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/operations/troubleshooting/" title="Troubleshooting" class="dd-item 
        
        
        
        ">
      <a href="/operations/troubleshooting/">
          Troubleshooting
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/operations/known-issues/" title="Known Issues" class="dd-item 
        
        
        
        ">
      <a href="/operations/known-issues/">
          Known Issues
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/operations/cleanup/" title="Uninstalling Submariner" class="dd-item 
        
        
        
        ">
      <a href="/operations/cleanup/">
          Uninstalling Submariner
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/community/" title="Community" class="dd-item 
        
        
        
        ">
      <a href="/community/">
          <b>3. </b>Community
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/community/code-of-conduct/" title="Code of Conduct" class="dd-item 
        
        
        
        ">
      <a href="/community/code-of-conduct/">
          Code of Conduct
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/community/contributor-roles/" title="Contributor Roles" class="dd-item 
        
        
        
        ">
      <a href="/community/contributor-roles/">
          Contributor Roles
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/community/getting-help/" title="Getting Help" class="dd-item 
        
        
        
        ">
      <a href="/community/getting-help/">
          Getting Help
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/community/releases/" title="Releases" class="dd-item 
        
        
        
        ">
      <a href="/community/releases/">
          Releases
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/community/roadmap/" title="Roadmap" class="dd-item 
        
        
        
        ">
      <a href="/community/roadmap/">
          Roadmap
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/development/" title="Development" class="dd-item 
        
        
        
        ">
      <a href="/development/">
          <b>4. </b>Development
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/development/backports/" title="Backports" class="dd-item 
        
        
        
        ">
      <a href="/development/backports/">
          Backports
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/development/building-testing/" title="Building and Testing" class="dd-item 
        
        
        
        ">
      <a href="/development/building-testing/">
          Building and Testing
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/development/building-testing/ci-maintenance/" title="CI/CD Maintenance" class="dd-item 
        
        
        
        ">
      <a href="/development/building-testing/ci-maintenance/">
          CI/CD Maintenance
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/development/code-review/" title="Code Review Guide" class="dd-item 
        
        
        
        ">
      <a href="/development/code-review/">
          Code Review Guide
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/development/contribution-guide/" title="Contributing to the Project" class="dd-item 
        
        
        
        ">
      <a href="/development/contribution-guide/">
          Contributing to the Project
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/development/website/" title="Contributing to the Website" class="dd-item 
        
        
        
        ">
      <a href="/development/website/">
          Contributing to the Website
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/development/website/style-guide/" title="Docs Style Guide" class="dd-item 
        
        
        
        ">
      <a href="/development/website/style-guide/">
          Docs Style Guide
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/development/licenses/" title="Licenses" class="dd-item 
        
        
        
        ">
      <a href="/development/licenses/">
          Licenses
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/development/release-process/" title="Release Process" class="dd-item 
        
        
        
        ">
      <a href="/development/release-process/">
          Release Process
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/development/security/" title="Security" class="dd-item 
        
        
        
        ">
      <a href="/development/security/">
          Security
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/development/security/reporting/" title="Security Reporting" class="dd-item 
        
        
        
        ">
      <a href="/development/security/reporting/">
          Security Reporting
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/development/security/containers/" title="Container Requirements" class="dd-item 
        
        
        
        ">
      <a href="/development/security/containers/">
          Container Requirements
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/development/security/secrets/" title="Secrets" class="dd-item 
        
        
        
        ">
      <a href="/development/security/secrets/">
          Secrets
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/development/shipyard/" title="Working with Shipyard" class="dd-item 
        
        
        
        ">
      <a href="/development/shipyard/">
          Working with Shipyard
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/development/shipyard/settings/" title="Customizing Deployments" class="dd-item 
        
        
        
        ">
      <a href="/development/shipyard/settings/">
          Customizing Deployments
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/development/shipyard/targets/" title="Shared Targets" class="dd-item 
        
        
        
        ">
      <a href="/development/shipyard/targets/">
          Shared Targets
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/development/shipyard/images/" title="Image Related Targets" class="dd-item 
        
        
        
        ">
      <a href="/development/shipyard/images/">
          Image Related Targets
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/other-resources/" title="Other Resources" class="dd-item 
        
        
        
        ">
      <a href="/other-resources/">
          <b>5. </b>Other Resources
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="https://github.com/submariner-io/"><i class='fab fa-fw fa-github'></i> GitHub</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://kubernetes.slack.com/archives/C010RJV694M"><i class='fab fa-fw fa-slack'></i> Slack</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://bit.ly/submariner-users"><i class='fas fa-fw fa-envelope'></i> User mailing list</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://bit.ly/submariner-dev"><i class='fas fa-fw fa-envelope'></i> Devel mailing list</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://www.youtube.com/channel/UCZ3brSgl2v4boglZoeChClQ/videos"><i class='fas fa-fw fa-video'></i> YouTube</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://twitter.com/submarinerio"><i class='fab fa-fw fa-twitter'></i> Twitter</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://calendar.google.com/calendar?cid=NHFuZGVoOGY0bzZ1ajlvZnBsczh1NWNlZ2tAZ3JvdXAuY2FsZW5kYXIuZ29vZ2xlLmNvbQ"><i class='fas fa-fw fa-calendar'></i> Google Calendar</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
      
      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      <center>
    
    <a class="github-button" href="https://github.com/submariner-io/releases/releases" data-icon="octicon-cloud-download" aria-label="Download Submariner/subctl on github">Download</a>

    
    <a class="github-button" href="https://github.com/submariner-io/submariner" data-icon="octicon-star" data-show-count="true" aria-label="Star submariner-io/submariner on GitHub">Star</a>

    
    <a class="github-button" href="https://github.com/submariner-io/submariner/fork" data-icon="octicon-repo-forked" data-show-count="true" aria-label="Fork submariner-io/submariner on GitHub">Fork</a>

    <p>Copyright © The Submariner Contributors</p>

    <p>The Linux Foundation® (TLF) has registered trademarks and uses trademarks. For a list of TLF trademarks, see <a href="https://www.linuxfoundation.org/trademark-usage/">Trademark Usage</a></p>

    <p><a href="https://www.cncf.io">
        <img class="cncf-logo" src="https://raw.githubusercontent.com/cncf/artwork/master/other/cncf/horizontal/white/cncf-white.svg" alt="Cloud Native Computing Foundation">
    </a>
    Submariner is a <a href="https://www.cncf.io">Cloud Native Computing Foundation</a> sandbox project.</p>

</center>

<script async defer src="https://buttons.github.io/buttons.js"></script>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                  
                  
                  
                  <div id="top-github-link">
                    <a class="github-link" title='Edit this page' href="https://github.com/submariner-io/website/edit/devel/src/content/getting-started/quickstart/managed-kubernetes/gke/_index.md" target="blank">
                      <i class="fas fa-code-branch"></i>
                      <span id="top-github-link-text">Edit this page</span>
                    </a>
                  </div>
                  
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            
            
          
          
            
            
          
          
            <a href='/'></a> > <a href='/getting-started/'>Getting Started</a> > <a href='/getting-started/quickstart/'>Quickstart Guides</a> > <a href='/getting-started/quickstart/managed-kubernetes/'>Managed Kubernetes</a> > Google (GKE)
          
         
          
         
          
         
          
         
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#cluster-creation">Cluster Creation</a></li>
    <li><a href="#prepare-clusters-for-submariner">Prepare Clusters for Submariner</a>
      <ul>
        <li><a href="#preparation-node-configuration">Preparation: Node Configuration</a></li>
        <li><a href="#preparation-firewall-configuration">Preparation: Firewall Configuration</a></li>
        <li><a href="#preparation-globalnet">Preparation: Globalnet</a></li>
      </ul>
    </li>
    <li><a href="#deploy-submariner">Deploy Submariner</a>
      <ul>
        <li><a href="#workaround-for-kubedns">Workaround for KubeDNS</a></li>
      </ul>
    </li>
    <li><a href="#automated-verification">Automated Verification</a></li>
    <li><a href="#reconfig-after-node-restart">Reconfig after Node Restart</a></li>
    <li><a href="#clean-up">Clean Up</a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Google (GKE)
            </h1>
          

        




	<p>This quickstart guide covers deploying two Google Kubernetes Engine (GKE) clusters on Google Cloud Platform (GCP) and connecting them with
Submariner and <a href="https://submariner.io/getting-started/architecture/service-discovery/">Service Discovery</a>.</p>

<div class="notices info" ><p>The guide assumes clusters have non-overlapping Pod and Service CIDRs.
<a href="https://submariner.io/getting-started/architecture/globalnet/">Globalnet</a> can be used if overlapping CIDRs can&rsquo;t be avoided.</p>
</div>


<div class="notices info" ><p>The guide assumes you have the <a href="https://cloud.google.com/sdk/docs/install"><code>gcloud</code> binary installed and configured</a> and a <a href="https://cloud.google.com/kubernetes-engine/docs/quickstart#before-you-begin">GCP account with
billing enabled for the active project</a>.</p>
</div>

<h2 id="cluster-creation">Cluster Creation</h2>
<p>Create two identical Kubernetes clusters on GKE.
For this guide, the following minimal configuration was used, however not everything is required (see the note part below).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">gcloud container clusters create <span style="color:#e6db74">&#34;cluster-a&#34;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --zone <span style="color:#e6db74">&#34;europe-west3-a&#34;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --enable-ip-alias <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --cluster-ipv4-cidr <span style="color:#e6db74">&#34;10.0.0.0/14&#34;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --services-ipv4-cidr<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;10.4.0.0/20&#34;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --cluster-version <span style="color:#e6db74">&#34;1.17.13-gke.2001&#34;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --username <span style="color:#e6db74">&#34;admin&#34;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --machine-type <span style="color:#e6db74">&#34;g1-small&#34;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --image-type <span style="color:#e6db74">&#34;UBUNTU&#34;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --disk-type <span style="color:#e6db74">&#34;pd-ssd&#34;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --disk-size <span style="color:#e6db74">&#34;15&#34;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --num-nodes <span style="color:#e6db74">&#34;3&#34;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --network <span style="color:#e6db74">&#34;default&#34;</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">gcloud container clusters create <span style="color:#e6db74">&#34;cluster-b&#34;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --zone <span style="color:#e6db74">&#34;europe-west3-a&#34;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --enable-ip-alias <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --cluster-ipv4-cidr <span style="color:#e6db74">&#34;10.8.0.0/14&#34;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --services-ipv4-cidr<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;10.12.0.0/20&#34;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --cluster-version <span style="color:#e6db74">&#34;1.17.13-gke.2001&#34;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --username <span style="color:#e6db74">&#34;admin&#34;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --machine-type <span style="color:#e6db74">&#34;g1-small&#34;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --image-type <span style="color:#e6db74">&#34;UBUNTU&#34;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --disk-type <span style="color:#e6db74">&#34;pd-ssd&#34;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --disk-size <span style="color:#e6db74">&#34;15&#34;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --num-nodes <span style="color:#e6db74">&#34;3&#34;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --network <span style="color:#e6db74">&#34;default&#34;</span>
</code></pre></div>
<div class="notices note" ><p>Make sure to use Kubernetes version 1.17 or higher, set by <code>--cluster-version</code>. The latest versions are listed in the <a href="https://cloud.google.com/kubernetes-engine/docs/release-notes">GKE release
notes</a>.</p>
</div>

<h2 id="prepare-clusters-for-submariner">Prepare Clusters for Submariner</h2>
<p>The clusters need some changes in order for Submariner to successfully open the IPsec tunnel between them.</p>
<h3 id="preparation-node-configuration">Preparation: Node Configuration</h3>
<p>As of version 0.8 of Submariner (the current one while writing this), Google&rsquo;s native CNI plugin is not directly supported.
GKE clusters can be generated with Calico CNI instead, but this was not tested during this demo and therefore could hold surprises as well.</p>
<p>So as this guide uses Google&rsquo;s native CNI plugin, configuration is needed for the <code>eth0</code> interface of each node on every cluster.
The used workaround deploys <code>netshoot</code> pods onto each node that configure the reverse path filtering.
The scripts in <a href="https://github.com/sridhargaddam/k8sscripts/tree/main/rp_filter_settings">this</a> Github repository need to be executed
in all clusters.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">wget https://raw.githubusercontent.com/sridhargaddam/k8sscripts/main/rp_filter_settings/update-rp-filter.sh
wget https://raw.githubusercontent.com/sridhargaddam/k8sscripts/main/rp_filter_settings/configure-rp-filter.sh
chmod +x update-rp-filter.sh
chmod +x configure-rp-filter.sh
gcloud container clusters get-credentials cluster-a --zone<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;europe-west3-a&#34;</span>
./configure-rp-filter.sh
gcloud container clusters get-credentials cluster-b --zone<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;europe-west3-a&#34;</span>
./configure-rp-filter.sh
</code></pre></div><h3 id="preparation-firewall-configuration">Preparation: Firewall Configuration</h3>
<p>Submariner requires UDP ports 500, 4500, and 4800 to be open in both directions. Additionally the microservices&rsquo; traffic needs to flow
through the IPsec tunnel as TCP packets. Hence the TCP traffic has source and destination addresses originating in the participating
clusters. Create those firewall rules on the GCP project. Use the same IP ranges as in the cluster creation steps above.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">gcloud compute firewall-rules create <span style="color:#e6db74">&#34;allow-tcp-in&#34;</span> --allow<span style="color:#f92672">=</span>tcp <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  --direction<span style="color:#f92672">=</span>IN --source-ranges<span style="color:#f92672">=</span>10.12.0.0/20,10.8.0.0/14,10.4.0.0/20,10.0.0.0/14

gcloud compute firewall-rules create <span style="color:#e6db74">&#34;allow-tcp-out&#34;</span> --allow<span style="color:#f92672">=</span>tcp --direction<span style="color:#f92672">=</span>OUT <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  --destination-ranges<span style="color:#f92672">=</span>10.12.0.0/20,10.8.0.0/14,10.4.0.0/20,10.0.0.0/14

gcloud compute firewall-rules create <span style="color:#e6db74">&#34;udp-in-500&#34;</span> --allow<span style="color:#f92672">=</span>udp:500 --direction<span style="color:#f92672">=</span>IN
gcloud compute firewall-rules create <span style="color:#e6db74">&#34;udp-in-4500&#34;</span> --allow<span style="color:#f92672">=</span>udp:4500 --direction<span style="color:#f92672">=</span>IN
gcloud compute firewall-rules create <span style="color:#e6db74">&#34;udp-in-4800&#34;</span> --allow<span style="color:#f92672">=</span>udp:4800 --direction<span style="color:#f92672">=</span>IN

gcloud compute firewall-rules create <span style="color:#e6db74">&#34;udp-out-500&#34;</span> --allow<span style="color:#f92672">=</span>udp:500 --direction<span style="color:#f92672">=</span>OUT
gcloud compute firewall-rules create <span style="color:#e6db74">&#34;udp-out-4500&#34;</span> --allow<span style="color:#f92672">=</span>udp:4500 --direction<span style="color:#f92672">=</span>OUT
gcloud compute firewall-rules create <span style="color:#e6db74">&#34;udp-out-4800&#34;</span> --allow<span style="color:#f92672">=</span>udp:4800 --direction<span style="color:#f92672">=</span>OUT
</code></pre></div><h3 id="preparation-globalnet">Preparation: Globalnet</h3>
<p>Submariner Globalnet internally creates a Service with external IPs for every exported Service and sets the <code>ExternalIPs</code> to the global IP
assigned to the respective Service. By default, GKE clusters do not allow Services to be created with <code>ExternalIPs</code>, as it deploys the
<a href="https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/#denyserviceexternalips">DenyServiceExternalIPs admission
controller</a>. If you are planning to
install Submariner Globalnet, please make sure that you disable the admission controller by running the following command.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">gcloud container clusters update &lt;cluster-name&gt; --enable-service-externalips
</code></pre></div><p>You can further restrict the usage of Services with external IPs to selected Service Accounts as documented in the
<a href="https://submariner.io/getting-started/architecture/globalnet/#prerequisites">Globalnet Prerequisites</a>.</p>
<p>After this, the clusters are finally ready for Submariner!</p>
<h2 id="deploy-submariner">Deploy Submariner</h2>
<p>Download the subctl binary and make it available on your PATH.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">curl -Ls https://get.submariner.io | bash
export PATH<span style="color:#f92672">=</span>$PATH:~/.local/bin
echo export PATH<span style="color:#f92672">=</span><span style="color:#ae81ff">\$</span>PATH:~/.local/bin &gt;&gt; ~/.profile
</code></pre></div><p>If you have Go and the <a href="https://github.com/submariner-io/subctl">source code</a>, you can build and install subctl instead:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">cd go/src/submariner-io/subctl
go build -o $GOBIN/subctl github.com/submariner-io/subctl/cmd
</code></pre></div><p>(and ensure your <code>go/bin</code> directory is on your <code>PATH</code>).</p>
<p>Deploy the <a href="https://submariner.io/getting-started/architecture/broker/">Broker</a> on cluster-a.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">gcloud container clusters get-credentials cluster-a --zone<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;europe-west3-a&#34;</span>
subctl deploy-broker
</code></pre></div><p>The command will output a file named <code>broker-info.subm</code> to the directory it is run from, which will be used to setup the
IPsec tunnel between clusters.</p>
<p>Verify the Broker components are installed:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl get crds | grep submariner
clusters.submariner.io
endpoints.submariner.io
gateways.submariner.io

kubectl get crds --context cluster-a | grep multicluster
serviceexports.multicluster.x-k8s.io
serviceimports.multicluster.x-k8s.io

$ kubectl get ns | grep submariner

submariner-k8s-broker
</code></pre></div><p>Now it is time to register every cluster in the future <code>ClusterSet</code> to the Broker.</p>
<p>First join the Broker-hosting cluster itself to the Broker:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">gcloud container clusters get-credentials cluster-a --zone<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;europe-west3-a&#34;</span>
subctl join broker-info.subm --clusterid cluster-a --servicecidr 10.4.0.0/20
</code></pre></div><p>Submariner will figure out most required information on its own. The <code>--clusterid</code> and <code>--servicecidr</code> flags should be used to pass the same
values as during the cluster creation steps above. You will also see a dialogue on the terminal that asks you to decide which of the three
nodes will be the Gateway. Any node will work. It will be annotated with <code>submariner.io/gateway: true</code>.</p>
<p>When a cluster is joined, the Submariner Operator is installed. It creates several components in the <code>submariner-operator</code> namespace:</p>
<ul>
<li><code>submariner-gateway</code> DaemonSet, to open a gateway for the IPsec tunnel on one node</li>
<li><code>submariner-routeagent</code> DaemonSet, which runs on every worker node in order to route the internal traffic to the local gateway
via VXLAN tunnels</li>
<li><code>submariner-lighthouse-agent</code> Deployment, which accesses the Kubernetes API server in the Broker cluster to exchange Service
information with the Broker</li>
<li><code>submariner-lighthouse-coredns</code> Deployment, which - as an external DNS server - gets forwarded requests to the
<code>*.clusterset.local</code> domain for cross-cluster communication by Kubernetes&rsquo; internal DNS server</li>
</ul>
<p>Check the DaemonSets and Deployments with the following command:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ gcloud container clusters get-credentials cluster-a --zone<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;europe-west3-a&#34;</span>
$ kubectl get ds,deploy -n submariner-operator
NAME                                   DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR                AGE
daemonset.apps/submariner-gateway      <span style="color:#ae81ff">1</span>         <span style="color:#ae81ff">1</span>         <span style="color:#ae81ff">1</span>       <span style="color:#ae81ff">1</span>            <span style="color:#ae81ff">1</span>           submariner.io/gateway<span style="color:#f92672">=</span>true   5m29s
daemonset.apps/submariner-routeagent   <span style="color:#ae81ff">3</span>         <span style="color:#ae81ff">3</span>         <span style="color:#ae81ff">3</span>       <span style="color:#ae81ff">3</span>            <span style="color:#ae81ff">3</span>           &lt;none&gt;                       5m27s

NAME                                            READY   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/submariner-lighthouse-agent     1/1     <span style="color:#ae81ff">1</span>            <span style="color:#ae81ff">1</span>           5m28s
deployment.apps/submariner-lighthouse-coredns   2/2     <span style="color:#ae81ff">2</span>            <span style="color:#ae81ff">2</span>           5m27s
deployment.apps/submariner-operator             1/1     <span style="color:#ae81ff">1</span>            <span style="color:#ae81ff">1</span>           5m43s
</code></pre></div><p>Now join the second cluster to the Broker:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">gcloud container clusters get-credentials cluster-b --zone<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;europe-west3-a&#34;</span>
subctl join broker-info.subm --clusterid cluster-b --servicecidr 10.12.0.0/20
</code></pre></div><p>Then verify connectivity and CIDR settings within the <code>ClusterSet</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ gcloud container clusters get-credentials cluster-a --zone<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;europe-west3-a&#34;</span>
$ subctl show all
CLUSTER ID                    ENDPOINT IP     PUBLIC IP       CABLE DRIVER        TYPE
cluster-a                     10.156.0.8      34.107.75.239   libreswan           local
cluster-b                     10.156.0.13     35.242.247.43   libreswan           remote

GATEWAY                         CLUSTER                 REMOTE IP       CABLE DRIVER        SUBNETS                                 STATUS
gke-cluster-b-default-pool-e2e7 cluster-b               10.156.0.13     libreswan           10.12.0.0/20, 10.8.0.0/14               connected

NODE                            HA STATUS       SUMMARY
gke-cluster-a-default-pool-4e5f active          All connections <span style="color:#f92672">(</span>1<span style="color:#f92672">)</span> are established

COMPONENT                       REPOSITORY                                            VERSION
submariner                      quay.io/submariner                                    0.8.0-rc0
submariner-operator             quay.io/submariner                                    0.8.0-rc0
service-discovery               quay.io/submariner                                    0.8.0-rc0
$ gcloud container clusters get-credentials cluster-b --zone<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;europe-west3-a&#34;</span>
$ subctl show all
CLUSTER ID                    ENDPOINT IP     PUBLIC IP       CABLE DRIVER        TYPE
cluster-b                     10.156.0.13     35.242.247.43   libreswan           local
cluster-a                     10.156.0.8      34.107.75.239   libreswan           remote

GATEWAY                         CLUSTER                 REMOTE IP       CABLE DRIVER        SUBNETS                                 STATUS
gke-cluster-a-default-pool-4e5f cluster-a               10.156.0.8      libreswan           10.4.0.0/20, 10.0.0.0/14                connected

NODE                            HA STATUS       SUMMARY
gke-cluster-b-default-pool-e2e7 active          All connections <span style="color:#f92672">(</span>1<span style="color:#f92672">)</span> are established

COMPONENT                       REPOSITORY                                            VERSION
submariner                      quay.io/submariner                                    0.8.0-rc0
submariner-operator             quay.io/submariner                                    0.8.0-rc0
service-discovery               quay.io/submariner                                    0.8.0-rc0
</code></pre></div><h3 id="workaround-for-kubedns">Workaround for KubeDNS</h3>
<p>GKE uses KubeDNS by default for cluster-internal DNS queries. Submariner however only works with CoreDNS as of version 0.7. As a
consequence, the <code>*.clusterset.local</code> domain stub needs to be added manually to KubeDNS.
Query the ClusterIP of the <code>submariner-lighthouse-coredns</code> Service in cluster-a and cluster-b:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ gcloud container clusters get-credentials cluster-a --zone<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;europe-west3-a&#34;</span>
$ CLUSTER_IP<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>kubectl get svc submariner-lighthouse-coredns -n submariner-operator -o<span style="color:#f92672">=</span>custom-columns<span style="color:#f92672">=</span>ClusterIP:.spec.clusterIP | tail -n +2<span style="color:#66d9ef">)</span>
$ cat <span style="color:#e6db74">&lt;&lt;EOF | kubectl apply -f -
</span><span style="color:#e6db74">apiVersion: v1
</span><span style="color:#e6db74">kind: ConfigMap
</span><span style="color:#e6db74">data:
</span><span style="color:#e6db74">  stubDomains: |
</span><span style="color:#e6db74">    {&#34;clusterset.local&#34;:[&#34;$CLUSTER_IP&#34;]}
</span><span style="color:#e6db74">metadata:
</span><span style="color:#e6db74">  labels:
</span><span style="color:#e6db74">    addonmanager.kubernetes.io/mode: EnsureExists
</span><span style="color:#e6db74">  name: kube-dns
</span><span style="color:#e6db74">  namespace: kube-system
</span><span style="color:#e6db74">EOF</span>
$ gcloud container clusters get-credentials cluster-b --zone<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;europe-west3-a&#34;</span>
$ CLUSTER_IP<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>kubectl get svc submariner-lighthouse-coredns -n submariner-operator -o<span style="color:#f92672">=</span>custom-columns<span style="color:#f92672">=</span>ClusterIP:.spec.clusterIP | tail -n +2<span style="color:#66d9ef">)</span>
$ cat <span style="color:#e6db74">&lt;&lt;EOF | kubectl apply -f -
</span><span style="color:#e6db74">apiVersion: v1
</span><span style="color:#e6db74">kind: ConfigMap
</span><span style="color:#e6db74">data:
</span><span style="color:#e6db74">  stubDomains: |
</span><span style="color:#e6db74">    {&#34;clusterset.local&#34;:[&#34;$CLUSTER_IP&#34;]}
</span><span style="color:#e6db74">metadata:
</span><span style="color:#e6db74">  labels:
</span><span style="color:#e6db74">    addonmanager.kubernetes.io/mode: EnsureExists
</span><span style="color:#e6db74">  name: kube-dns
</span><span style="color:#e6db74">  namespace: kube-system
</span><span style="color:#e6db74">EOF</span>
</code></pre></div><h2 id="automated-verification">Automated Verification</h2>
<p>This will perform automated verifications between the clusters.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">KUBECONFIG<span style="color:#f92672">=</span>cluster-a.yml gcloud container clusters get-credentials cluster-a --zone<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;europe-west3-a&#34;</span>
KUBECONFIG<span style="color:#f92672">=</span>cluster-b.yml gcloud container clusters get-credentials cluster-b --zone<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;europe-west3-a&#34;</span>
KUBECONFIG<span style="color:#f92672">=</span>cluster-a.yml:cluster-b.yml subctl verify --context cluster-a --tocontext cluster-b --only service-discovery,connectivity --verbose
</code></pre></div><h2 id="reconfig-after-node-restart">Reconfig after Node Restart</h2>
<p>If the GKE Nodes were at some point drained or deleted, the Submariner Pods needed to terminate.
Once the Nodes are up again, remember to</p>
<ul>
<li>label one Node with <code>kubectl label node &lt;name&gt; submariner.io/gateway=true</code> in order for the Gateway to be deployed on this Node</li>
<li>apply the Node Configuration workaround again</li>
<li>change the applied KubeDNS workaround to reflect the current <code>submariner-lighthouse-coredns</code> IP.</li>
</ul>
<p>This makes Submariner functional again and work can be continued.</p>
<h2 id="clean-up">Clean Up</h2>
<p>When you&rsquo;re done, delete your clusters:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">gcloud container clusters delete cluster-a --zone<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;europe-west3-a&#34;</span>
gcloud container clusters delete cluster-b --zone<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;europe-west3-a&#34;</span>
</code></pre></div>




<footer class=" footline" >
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/getting-started/quickstart/managed-kubernetes/" title="Managed Kubernetes"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/getting-started/quickstart/managed-kubernetes/rancher/" title="Rancher" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1707219466"></script>
    <script src="/js/perfect-scrollbar.min.js?1707219466"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1707219466"></script>
    <script src="/js/jquery.sticky.js?1707219466"></script>
    <script src="/js/featherlight.min.js?1707219466"></script>
    <script src="/js/highlight.pack.js?1707219466"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1707219466"></script>
    <script src="/js/learn.js?1707219466"></script>
    <script src="/js/hugo-learn.js?1707219466"></script>

    <link href="/mermaid/mermaid.css?1707219466" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1707219466"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>
